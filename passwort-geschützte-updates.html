<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Passwortgesch√ºtzte Updates ‚Äì Harmony Keys</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f4f8fb;
      color: #333;
      padding: 2em;
    }
    .hidden { display: none; }
    .login-box {
      max-width: 400px;
      margin: 100px auto;
      padding: 2em;
      border-radius: 12px;
      background-color: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input[type="password"] {
      width: 100%;
      padding: 0.5em;
      margin-top: 1em;
      margin-bottom: 1em;
      font-size: 1em;
    }
    button {
      padding: 0.5em 1em;
      font-size: 1em;
      background-color: #4a90e2;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .updates {
      max-width: 800px;
      margin: 2em auto;
    }
    h2, h3 {
      color: #1f3b69;
    }
    a {
      color: #4a90e2;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    ul {
      line-height: 1.6;
    }
    .toplink {
      text-align: right;
      margin-bottom: -1.5em;
    }
  </style>
</head>
<body>

<div id="login" class="login-box">
  <h2>üîê Login erforderlich</h2>
  <p>Bitte gib das Passwort ein, um auf die gesch√ºtzten Updates zuzugreifen.</p>
  <input type="password" id="pw" placeholder="Passwort eingeben">
  <button onclick="checkPassword()">Einloggen</button>
  <p id="error" style="color: red; display: none;">‚ùå Falsches Passwort</p>
</div>

<div id="content" class="updates hidden">
  <div class="toplink"><a href="/">Zur Hauptseite</a></div>
  <h2>üì¶ Passwortgesch√ºtzte Updates</h2>
  <p>Hier findest du alle neuen Inhalte, Zusatzmaterialien und Korrekturen.</p>
  <div id="update-list"></div>
</div>

<script>
  const correct = "harmony2025";

  function checkPassword() {
    const input = document.getElementById("pw").value;
    if (input === correct) {
      localStorage.setItem("harmony-keys-auth", "true");
      unlock();
    } else {
      document.getElementById("error").style.display = "block";
    }
  }

  function unlock() {
    document.getElementById("login").style.display = "none";
    document.getElementById("content").classList.remove("hidden");
    loadUpdates();
  }

  function loadUpdates() {
    fetch('updates.json')
      .then(res => res.json())
      .then(data => {
        const container = document.getElementById("update-list");
        data.forEach(update => {
          const block = document.createElement("div");
          block.innerHTML = `<h3>üÜï Update vom ${update.datum}</h3><ul>` +
            update.eintr√§ge.map(item => `
              <li>${item.titel}: <a href="${item.link}" target="_blank">${item.text}</a></li>
            `).join("") +
            "</ul>";
          container.appendChild(block);
        });
      })
      .catch(err => {
        document.getElementById("update-list").innerHTML = "<p style='color:red;'>Fehler beim Laden der Updates.</p>";
        console.error("Fehler beim Laden von updates.json:", err);
      });
  }

  // Enter-Taste aktivieren
  document.getElementById("pw").addEventListener("keyup", function(event) {
    if (event.key === "Enter") {
      checkPassword();
    }
  });

  // Beim Start pr√ºfen
  document.addEventListener("DOMContentLoaded", function () {
    if (localStorage.getItem("harmony-keys-auth") === "true") {
      unlock();
    }
  });
</script>

</body>
</html>
